**Оглавление**

- [MVC архитектура](#mvc)
- [Структура проектов](#stucture)
- [Цикл разработки](#develop)

*[к оглавлению](main.md)*

---

### Основные концепции

В данной статье будут освещены основные концепции фреймворка Regenix. Вы также
узнаете что представляет из себя веб-приложение созданное на Regenix, из каких
частей оно состоит.


#### MVC Архитектура

Проекты созданные на Regenix используют архитектуру MVC - Модель-Представление-Контроллер.
Разделение сущностей на 3 слоя:

- *Модель* - отвечает за связыванние данных из БД с объектами в вашем приложением. Может
иметь дополнительные классы сервисы для сохранения/удаления/поиска модели.

- *Представление* - или просто шаблон, если вы программировали на PHP без использования CMS
и фреймворков скорее всего вы использовали вставки `<php echo ...?>` для того чтбы вставить
переменную на страницу или что-то еще. Так вот, в Regenix представление отделено от логики,
оно отвечает только за вывод информации и не должно содержать логики работы с данными, моделями.

- *Контроллеры* - этот слой абстракции обеспечивает связь между моделями и представлениями, они
также отвечают за взаимодействие пользователя с веб-приложением. Грубо говоря, они выполняют роль
php скриптов, без html вставок, содержат только логику работы с запросами от пользователей.

В Regenix моделями и контроллерами являются PHP классы, которые унаследованы от базовых абстрактны
классов, например контроллеры от `framework\mvc\Controller` класса.

> Regenix поддерживает прозрачную MVC архитектуру не только для проектов, но и для модулей фреймворка.


#### Структура проектов

Все проекты Regenix находятся в папке `/apps/`. На одном ядре фреймворка могут работать сразу
несколько проектов. Любая папка в `/apps/` является отдельным проектом, например
`/apps/myproject/` это проект с id = `myproject`. В этой папке и находятся все исходники
вашего проекта. Таким образом вы можете создать несколько папок для нескольких проектов,
по шаблону `/apps/<название_проекта>/`.

> **РЕКОМЕНДАЦИЯ**: В кодовом названии проекта используйте только латинские
> символы, знаки подчеркивания и цифры, это поможет избежать множества проблем в будущем.


**Файлы и папки проекта**

Файловая структура одного проекта:

    - /app/
        - /app/controllers/ - контроллеры
        - /app/models/ - модели
        - /app/views/ - представления (шаблоны)
        - /app/tests/ - unit и другие тесты
        - /app/* - любые другие пакеты namespace
    - /assets/ - статичные файлы проекта, которые не являются загружаемыми файлами пользователей.
    - /conf/ - файлы конфигураций
        - /conf/application.conf - главный и основной файл конфигурации фреймворка
        - /conf/i18n/ - папка с файлами локализации ".lang"
        - /conf/route - файл конфигурации роутинга (ЧПУ)
    - /log/ - папка для хранения логов (должен быть доступ для записи)
    - /tmp/ - папка для временных temp файлов (доступ для записи обязателен)

В структуре проекта нет ничего сложного. Все классы необходимо объявлять в namespace'ах по стандарту
PSR-0. Для примера:

    <?php
    namespace controllers;

    class MyController {
    ...
    ?>

Данный класс должен находится по адресу `/app/controllers/MyController.php`. Если `namespace` будет
`controllers\sub`, то необходимо сохранять его в `/app/controllers/sub/MyController.php`.

> ВАЖНО: Вам не нужно следить за загрузкой нужных php файлов через `include` или `require`.
> Этим занимается фреймворк, с помощью Classloader'а он загружает только используемые классы
> по правилам PSR-0 стандарта.



#### Цикл разработки

Стандартный цикл разработки PHP приложений это обновил код, открыл браузер, посмотрел изменения.
В Regenix тот же принцип разработки, с тем отличием, что фреймворк выводит ошибки в более
удобном виде, в этом вы убедитесь сами, когда попробуете поработать с Regenix.

По-умолчанию в фреймворке есть 2 режима работы приложения:

- `prod` - продакшен режим работы, когда приложение готово к работе, ошибки только логируются, используются разные оптимизации
- `dev` - режим для разработки, когда нужно обеспечить максимум для отображения и контроля ошибок в приложении.

DEV режим отличается тем, что выводит ошибки в очень подробном виде, показывая даже часть кода, в котором произошла
ошибка. Он также не использует внутреннее кеширование и оптимизации. Его не стоит включать на работающем сайте.

PROD режим напротив необходимо включать когда приложение готово к работе или на продакшен сервере.

Режим работы приложения меняется в файле конфигурации `/conf/application.conf`:

    app.mode = dev
    app.mode = prod

Из любого места в вашем коде вы можете узнать, в каком режиме работает приложение. Для этого
существуют константы: `IS_DEV`, `IS_PROD`, `APP_MODE`. Эти константы вы можете смело использовать.